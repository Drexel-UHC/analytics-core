<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Analytics Corner</title>
<link>https://Drexel-UHC.github.io/analytics-corner/pages/blog/index.html</link>
<atom:link href="https://Drexel-UHC.github.io/analytics-corner/pages/blog/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<image>
<url>https://Drexel-UHC.github.io/analytics-corner/uhc.png</url>
<title>Analytics Corner</title>
<link>https://Drexel-UHC.github.io/analytics-corner/pages/blog/index.html</link>
<height>102</height>
<width>144</width>
</image>
<generator>quarto-1.2.241</generator>
<lastBuildDate>Wed, 10 Aug 2022 04:00:00 GMT</lastBuildDate>
<item>
  <title>Visualization faceted by state</title>
  <dc:creator>Ran Li</dc:creator>
  <link>https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto.html</link>
  <description><![CDATA[ 



<section id="issue" class="level1">
<h1>Issue</h1>
<p><strong><a href="https://github.com/Drexel-UHC/analytics-corner/issues/7" class="uri">https://github.com/Drexel-UHC/analytics-corner/issues/7</a></strong></p>
<blockquote class="blockquote">
<p>I’m hoping to make a figure that shows different policy statuses of states (abortion ban, proposed abortion ban, no abortion ban; Paid family leave, no paid family leave; paid family leave preemption, no preemption), with the states in the location of the US map…</p>
<p>I think geofacet mightttt get us close to the figure I’m hoping to make, but not quitee there.</p>
</blockquote>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/images/paste-24B14202.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="evaluation" class="level1">
<h1>Evaluation</h1>
<p>Just a brief breakdown of the plot above from the <a href="https://www.scientificamerican.com/article/graphic-many-states-that-restrict-or-ban-abortion-dont-teach-kids-about-sex-and-pregnancy/">original article</a>. There are two layers: 1) rectangles show abortion policy categories 2) triangles show various degrees of coverage within sexual education by topic (contraception in blue vs abstinence in orange). In other words larger/more-orange triangle at bottom indicates more sexual seduction emphasize abstinence and large/more-blue triangle at top indicates more sexual education emphasis on contraception. In terms of data there each state would have three points: abortion policy categories, coverage of contraception, coverage of abstinence.</p>
<p>Lets take a look at the data sent over along with this request.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(janitor)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(readxl)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">library</span>(tidyverse)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;">library</span>(geofacet)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;">library</span>(cowplot)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="do" style="color: #5E5E5E;
font-style: italic;">## raw data</span></span>
<span id="cb1-8">raw_data <span class="ot" style="color: #003B4F;">=</span> readxl<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_excel</span>(<span class="at" style="color: #657422;">path =</span> <span class="st" style="color: #20794D;">"raw-data/family medical leave preemption dataset 9-19-22.xlsx"</span>,</span>
<span id="cb1-9">                              <span class="at" style="color: #657422;">sheet =</span> <span class="st" style="color: #20794D;">'Sheet2'</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;">select</span>(<span class="at" style="color: #657422;">name =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">family_leave =</span> <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">preemption =</span> <span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">abortion_ban_risk =</span> <span class="dv" style="color: #AD0000;">4</span>)  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;">drop_na</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;">mutate_all</span>(<span class="sc" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;">as.character</span>(.x))</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="do" style="color: #5E5E5E;
font-style: italic;">## clean state codes</span></span>
<span id="cb1-15">xwalk_states <span class="ot" style="color: #003B4F;">=</span> geofacet<span class="sc" style="color: #5E5E5E;">::</span>state_ranks <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;">select</span>(name, state) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-17">  <span class="fu" style="color: #4758AB;">distinct</span>()</span>
<span id="cb1-18">data <span class="ot" style="color: #003B4F;">=</span> raw_data <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">name =</span> name <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-20">           <span class="fu" style="color: #4758AB;">recode</span>(<span class="st" style="color: #20794D;">"Washington DC"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"District of Columbia"</span>,</span>
<span id="cb1-21">                  <span class="st" style="color: #20794D;">"New Hampshire*"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"New Hampshire"</span>),) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-22">  <span class="fu" style="color: #4758AB;">left_join</span>(xwalk_states)</span>
<span id="cb1-23">data</span></code></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["family_leave"],"name":[2],"type":["chr"],"align":["left"]},{"label":["preemption"],"name":[3],"type":["chr"],"align":["left"]},{"label":["abortion_ban_risk"],"name":[4],"type":["chr"],"align":["left"]},{"label":["state"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Alabama","2":"0","3":"1","4":"3","5":"AL"},{"1":"Alaska","2":"0","3":"0","4":"0","5":"AK"},{"1":"Arizona","2":"0","3":"0","4":"2","5":"AZ"},{"1":"Arkansas","2":"0","3":"1","4":"3","5":"AR"},{"1":"California","2":"1","3":"0","4":"0","5":"CA"},{"1":"Colorado","2":"1","3":"0","4":"0","5":"CO"},{"1":"Connecticut","2":"1","3":"0","4":"0","5":"CT"},{"1":"Delaware","2":"1","3":"0","4":"0","5":"DE"},{"1":"Florida","2":"0","3":"1","4":"0","5":"FL"},{"1":"Georgia","2":"0","3":"1","4":"2","5":"GA"},{"1":"Hawaii","2":"0","3":"0","4":"0","5":"HI"},{"1":"Idaho","2":"0","3":"0","4":"2","5":"ID"},{"1":"Illinois","2":"0","3":"0","4":"0","5":"IL"},{"1":"Indiana","2":"0","3":"1","4":"2","5":"IN"},{"1":"Iowa","2":"0","3":"1","4":"2","5":"IA"},{"1":"Kansas","2":"0","3":"1","4":"0","5":"KS"},{"1":"Kentucky","2":"0","3":"1","4":"3","5":"KY"},{"1":"Louisiana","2":"0","3":"1","4":"3","5":"LA"},{"1":"Maine","2":"0","3":"0","4":"0","5":"ME"},{"1":"Maryland","2":"1","3":"0","4":"0","5":"MD"},{"1":"Massachusetts","2":"1","3":"0","4":"0","5":"MA"},{"1":"Michigan","2":"0","3":"1","4":"2","5":"MI"},{"1":"Minnesota","2":"0","3":"0","4":"0","5":"MN"},{"1":"Mississippi","2":"0","3":"1","4":"3","5":"MS"},{"1":"Missouri","2":"0","3":"1","4":"3","5":"MO"},{"1":"Montana","2":"0","3":"0","4":"0","5":"MT"},{"1":"Nebraska","2":"0","3":"0","4":"2","5":"NE"},{"1":"Nevada","2":"0","3":"0","4":"0","5":"NV"},{"1":"New Hampshire","2":"0","3":"0","4":"1","5":"NH"},{"1":"New Jersey","2":"1","3":"0","4":"0","5":"NJ"},{"1":"New Mexico","2":"0","3":"0","4":"1","5":"NM"},{"1":"New York","2":"1","3":"0","4":"0","5":"NY"},{"1":"North Carolina","2":"0","3":"1","4":"2","5":"NC"},{"1":"North Dakota","2":"0","3":"1","4":"2","5":"ND"},{"1":"Ohio","2":"0","3":"1","4":"2","5":"OH"},{"1":"Oklahoma","2":"0","3":"1","4":"3","5":"OK"},{"1":"Oregon","2":"1","3":"0","4":"0","5":"OR"},{"1":"Pennsylvania","2":"0","3":"0","4":"2","5":"PA"},{"1":"Rhode Island","2":"1","3":"0","4":"0","5":"RI"},{"1":"South Carolina","2":"0","3":"1","4":"2","5":"SC"},{"1":"South Dakota","2":"0","3":"0","4":"3","5":"SD"},{"1":"Tennessee","2":"0","3":"1","4":"2","5":"TN"},{"1":"Texas","2":"0","3":"0","4":"2","5":"TX"},{"1":"Utah","2":"0","3":"0","4":"2","5":"UT"},{"1":"Vermont","2":"0","3":"0","4":"0","5":"VT"},{"1":"Virginia","2":"0","3":"0","4":"1","5":"VA"},{"1":"Washington","2":"1","3":"0","4":"0","5":"WA"},{"1":"West Virginia","2":"0","3":"0","4":"2","5":"WV"},{"1":"Wisconsin","2":"0","3":"1","4":"2","5":"WI"},{"1":"Wyoming","2":"0","3":"0","4":"2","5":"WY"},{"1":"District of Columbia","2":"1","3":"0","4":"0","5":"DC"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Adapting this visualization to the table above would give the following features:</p>
<ol type="1">
<li>The rectangle would be similiar with shade mapping to the abortion ban risk</li>
<li>The top blue triangle would map to family leave.</li>
<li>The bottom orange triangle would map to preemption family leave. I am assuming preemption is bad?</li>
</ol>
</section>
<section id="proof-of-concept" class="level1">
<h1>Proof of concept</h1>
<p>The whole workflow relies on <a href="https://hafen.github.io/geofacet/"><code>geofacet::face_geo()</code></a>. The main function in this package is facet_geo() and its use can be thought of as equivalent to ggplot2’s facet_wrap() except for the output it creates. The first step is to create a function that creates the individual state plots.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Set coordinates</span></span>
<span id="cb2-2">container_width_height <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">10</span> <span class="co" style="color: #5E5E5E;"># a 10 by 10 coordinate system</span></span>
<span id="cb2-3">rect_width <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">6</span> </span>
<span id="cb2-4">rect_height <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">3</span></span>
<span id="cb2-5">rect_xmin <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb2-6">rect_xmax <span class="ot" style="color: #003B4F;">=</span> rect_xmin <span class="sc" style="color: #5E5E5E;">+</span> rect_width</span>
<span id="cb2-7">rect_x_mean <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">mean</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_xmin,rect_xmax))</span>
<span id="cb2-8">rect_ymin <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">4</span></span>
<span id="cb2-9">rect_ymax <span class="ot" style="color: #003B4F;">=</span> rect_ymin <span class="sc" style="color: #5E5E5E;">+</span> rect_height </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Append coordinates to data for geom_polygon</span></span>
<span id="cb2-12">data_w_coords <span class="ot" style="color: #003B4F;">=</span> data <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">top_triangle_x =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_xmin,rect_xmax,rect_x_mean)),</span>
<span id="cb2-14">         <span class="at" style="color: #657422;">top_triangle_y =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_ymax,rect_ymax,rect_ymax<span class="sc" style="color: #5E5E5E;">+</span>rect_height)),</span>
<span id="cb2-15">         <span class="at" style="color: #657422;">bottom_triangle_x =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_xmin,rect_xmax,rect_x_mean)),</span>
<span id="cb2-16">         <span class="at" style="color: #657422;">bottom_triangle_y =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_ymin,rect_ymin,rect_ymin<span class="sc" style="color: #5E5E5E;">-</span>rect_height))</span>
<span id="cb2-17">  ) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb2-18">  <span class="fu" style="color: #4758AB;">unnest</span>(<span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(top_triangle_x, top_triangle_y, bottom_triangle_x, bottom_triangle_y))</span>
<span id="cb2-19"></span>
<span id="cb2-20"></span>
<span id="cb2-21"><span class="do" style="color: #5E5E5E;
font-style: italic;">## create a function to make basic shapes</span></span>
<span id="cb2-22">geom_hex_for_alina_poc <span class="ot" style="color: #003B4F;">=</span> <span class="cf" style="color: #003B4F;">function</span>(data){</span>
<span id="cb2-23">  data <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb2-24">    <span class="fu" style="color: #4758AB;">ggplot</span>()  <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb2-25">    <span class="fu" style="color: #4758AB;">geom_rect</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xmin =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">xmax =</span> <span class="dv" style="color: #AD0000;">10</span>, <span class="at" style="color: #657422;">ymin =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">ymax =</span> <span class="dv" style="color: #AD0000;">10</span>),  <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"white"</span>) <span class="sc" style="color: #5E5E5E;">+</span> <span class="co" style="color: #5E5E5E;"># 10 by 10 container</span></span>
<span id="cb2-26">    <span class="fu" style="color: #4758AB;">geom_rect</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xmin =</span> rect_xmin, <span class="at" style="color: #657422;">xmax =</span> rect_xmax,<span class="at" style="color: #657422;">ymin =</span>rect_ymin, <span class="at" style="color: #657422;">ymax =</span> rect_ymax),    <span class="co" style="color: #5E5E5E;"># add rectangle</span></span>
<span id="cb2-27">              <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"black"</span>, <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"grey"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb2-28">    <span class="fu" style="color: #4758AB;">geom_polygon</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x=</span>top_triangle_x,<span class="at" style="color: #657422;">y=</span>top_triangle_y), <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">'blue'</span>) <span class="sc" style="color: #5E5E5E;">+</span> <span class="co" style="color: #5E5E5E;"># top triangle</span></span>
<span id="cb2-29">    <span class="fu" style="color: #4758AB;">geom_polygon</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> bottom_triangle_x, <span class="at" style="color: #657422;">y =</span> bottom_triangle_y),  <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">'red'</span>) <span class="sc" style="color: #5E5E5E;">+</span>   <span class="co" style="color: #5E5E5E;"># bottom triangle</span></span>
<span id="cb2-30">    <span class="fu" style="color: #4758AB;">theme_void</span>()</span>
<span id="cb2-31">}</span>
<span id="cb2-32"></span>
<span id="cb2-33"></span>
<span id="cb2-34"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Test function to plot for a single state</span></span>
<span id="cb2-35">data_w_coords <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb2-36">  <span class="fu" style="color: #4758AB;">filter</span>(name <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"Alabama"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb2-37">  <span class="fu" style="color: #4758AB;">geom_hex_for_alina_poc</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Great now let’s us this just append a <a href="https://hafen.github.io/geofacet/"><code>geofacet::face_geo()</code></a> to do do the by state faceting; note we are now passing all the states data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">data_w_coords <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;">geom_hex_for_alina_poc</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;">facet_geo</span>(<span class="sc" style="color: #5E5E5E;">~</span> state) </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Great I think this approach is getting us to what we want.</p>
</section>
<section id="ggplot-components-for-deliverable" class="level1">
<h1>GGplot components for deliverable</h1>
<p>There are a few things to do to polish it a bit.</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">display triangles based on the data features</li>
<li><input type="checkbox" disabled="" checked="">display abortion ban risk as shade of triangle</li>
<li><input type="checkbox" disabled="" checked="">minimize the inidividual plot margins (to make the layout more similiar to our example)</li>
<li><input type="checkbox" disabled="" checked="">remove facet_wrap strip text/label</li>
<li><input type="checkbox" disabled="" checked="">move the 2 letter state abbrv into the rectangle</li>
</ul>
<section id="plot" class="level2">
<h2 class="anchored" data-anchor-id="plot">Plot</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Set coordinates</span></span>
<span id="cb4-2">height <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">10</span> </span>
<span id="cb4-3">padding_x <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">1</span></span>
<span id="cb4-4">width <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">8</span></span>
<span id="cb4-5">rect_xmin <span class="ot" style="color: #003B4F;">=</span> padding_x</span>
<span id="cb4-6">rect_xmax <span class="ot" style="color: #003B4F;">=</span> width <span class="sc" style="color: #5E5E5E;">+</span> padding_x</span>
<span id="cb4-7">rect_x_mean <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">mean</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_xmin,rect_xmax))</span>
<span id="cb4-8">rect_ymin <span class="ot" style="color: #003B4F;">=</span> height<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">3</span></span>
<span id="cb4-9">rect_ymax <span class="ot" style="color: #003B4F;">=</span> rect_ymin<span class="sc" style="color: #5E5E5E;">*</span><span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Manual colors for data features</span></span>
<span id="cb4-12">abortion_colors <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"0"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"#e7e8e9"</span>,</span>
<span id="cb4-13">                    <span class="st" style="color: #20794D;">"1"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"#A6A7AA"</span>, </span>
<span id="cb4-14">                    <span class="st" style="color: #20794D;">"2"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"#757679"</span>,</span>
<span id="cb4-15">                    <span class="st" style="color: #20794D;">"3"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"#000000"</span>)</span>
<span id="cb4-16"></span>
<span id="cb4-17">xwalk_colors <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">c</span>(abortion_colors,</span>
<span id="cb4-18">                 <span class="st" style="color: #20794D;">"white"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"white"</span>,</span>
<span id="cb4-19">                 <span class="st" style="color: #20794D;">"black"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"black"</span>,</span>
<span id="cb4-20">                 <span class="st" style="color: #20794D;">"0_family_leave"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"white"</span>,</span>
<span id="cb4-21">                 <span class="st" style="color: #20794D;">"1_family_leave"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"#00aeef"</span>,</span>
<span id="cb4-22">                 <span class="st" style="color: #20794D;">"0_preemption"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"white"</span>,</span>
<span id="cb4-23">                 <span class="st" style="color: #20794D;">"1_preemption"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"#f1592a"</span>)     </span>
<span id="cb4-24"></span>
<span id="cb4-25"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Operationalize data for plot</span></span>
<span id="cb4-26">data_processed <span class="ot" style="color: #003B4F;">=</span> data <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb4-27">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## Append coordinates to data for geom_polygon</span></span>
<span id="cb4-28">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">top_triangle_x =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_xmin,rect_xmax,rect_x_mean)),</span>
<span id="cb4-29">         <span class="at" style="color: #657422;">top_triangle_y =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_ymax,rect_ymax,height)),</span>
<span id="cb4-30">         <span class="at" style="color: #657422;">bottom_triangle_x =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_xmin,rect_xmax,rect_x_mean)),</span>
<span id="cb4-31">         <span class="at" style="color: #657422;">bottom_triangle_y =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">c</span>(rect_ymin,rect_ymin,<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb4-32">  ) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;">unnest</span>(<span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(top_triangle_x, top_triangle_y, bottom_triangle_x, bottom_triangle_y)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb4-34">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## operationalize colors</span></span>
<span id="cb4-35">  <span class="fu" style="color: #4758AB;">mutate</span>(</span>
<span id="cb4-36">    <span class="at" style="color: #657422;">state_text =</span> <span class="fu" style="color: #4758AB;">ifelse</span>(<span class="fu" style="color: #4758AB;">as.numeric</span>(abortion_ban_risk)<span class="sc" style="color: #5E5E5E;">&gt;</span><span class="dv" style="color: #AD0000;">1</span>, <span class="st" style="color: #20794D;">"white"</span>,<span class="st" style="color: #20794D;">"black"</span>),</span>
<span id="cb4-37">    <span class="at" style="color: #657422;">family_leave =</span> <span class="fu" style="color: #4758AB;">paste0</span>(family_leave,<span class="st" style="color: #20794D;">"_family_leave"</span>),</span>
<span id="cb4-38">    <span class="at" style="color: #657422;">preemption =</span> <span class="fu" style="color: #4758AB;">paste0</span>(preemption,<span class="st" style="color: #20794D;">"_preemption"</span>))</span>
<span id="cb4-39"></span>
<span id="cb4-40"></span>
<span id="cb4-41"><span class="do" style="color: #5E5E5E;
font-style: italic;">## create a function to make basic shapes</span></span>
<span id="cb4-42">geom_hex_for_alina <span class="ot" style="color: #003B4F;">=</span> <span class="cf" style="color: #003B4F;">function</span>(gg){</span>
<span id="cb4-43">  gg <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-44">    <span class="do" style="color: #5E5E5E;
font-style: italic;">## add rectangle</span></span>
<span id="cb4-45">    <span class="fu" style="color: #4758AB;">geom_rect</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xmin =</span> rect_xmin, <span class="at" style="color: #657422;">xmax =</span> rect_xmax,   </span>
<span id="cb4-46">                  <span class="at" style="color: #657422;">ymin =</span> rect_ymin, <span class="at" style="color: #657422;">ymax =</span> rect_ymax, </span>
<span id="cb4-47">                  <span class="at" style="color: #657422;">fill =</span> abortion_ban_risk)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-48">    <span class="do" style="color: #5E5E5E;
font-style: italic;">## Add state abbrv text</span></span>
<span id="cb4-49">    <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> state, <span class="at" style="color: #657422;">color =</span> state_text),</span>
<span id="cb4-50">              <span class="at" style="color: #657422;">x =</span> height<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">y =</span> height<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>,</span>
<span id="cb4-51">              <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">3</span>)<span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-52">    <span class="do" style="color: #5E5E5E;
font-style: italic;">## Top triangle (family leave)</span></span>
<span id="cb4-53">    <span class="fu" style="color: #4758AB;">geom_polygon</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x=</span>top_triangle_x,<span class="at" style="color: #657422;">y=</span>top_triangle_y, <span class="at" style="color: #657422;">fill =</span> family_leave)) <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb4-54">    <span class="do" style="color: #5E5E5E;
font-style: italic;">## Bottom triangle (preemption)</span></span>
<span id="cb4-55">    <span class="fu" style="color: #4758AB;">geom_polygon</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> bottom_triangle_x, <span class="at" style="color: #657422;">y =</span> bottom_triangle_y, <span class="at" style="color: #657422;">fill =</span> preemption)) <span class="sc" style="color: #5E5E5E;">+</span>   </span>
<span id="cb4-56">    <span class="do" style="color: #5E5E5E;
font-style: italic;">## Manual colors</span></span>
<span id="cb4-57">    <span class="fu" style="color: #4758AB;">scale_fill_manual</span>(<span class="at" style="color: #657422;">values =</span> xwalk_colors) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-58">    <span class="fu" style="color: #4758AB;">scale_color_manual</span>(<span class="at" style="color: #657422;">name =</span> <span class="st" style="color: #20794D;">"state_text"</span>, <span class="at" style="color: #657422;">values =</span> xwalk_colors) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-59">    <span class="fu" style="color: #4758AB;">theme_void</span>()<span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb4-60">    <span class="fu" style="color: #4758AB;">theme</span>(</span>
<span id="cb4-61">      <span class="do" style="color: #5E5E5E;
font-style: italic;">## Completely remove facet labels</span></span>
<span id="cb4-62">      <span class="at" style="color: #657422;">strip.background =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb4-63">      <span class="at" style="color: #657422;">strip.text.x =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb4-64">      <span class="do" style="color: #5E5E5E;
font-style: italic;">## Remove legend</span></span>
<span id="cb4-65">      <span class="at" style="color: #657422;">legend.position =</span> <span class="st" style="color: #20794D;">'none'</span></span>
<span id="cb4-66">    )</span>
<span id="cb4-67">}</span>
<span id="cb4-68"></span>
<span id="cb4-69"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Test facet</span></span>
<span id="cb4-70">plot <span class="ot" style="color: #003B4F;">=</span> data_processed <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb4-71">  <span class="fu" style="color: #4758AB;">ggplot</span>()  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb4-72">  <span class="fu" style="color: #4758AB;">geom_hex_for_alina</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-73">  <span class="fu" style="color: #4758AB;">facet_geo</span>(<span class="sc" style="color: #5E5E5E;">~</span> state, <span class="at" style="color: #657422;">grid =</span> <span class="st" style="color: #20794D;">"us_state_grid2"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-74">  <span class="fu" style="color: #4758AB;">theme</span>(<span class="at" style="color: #657422;">plot.margin =</span> <span class="fu" style="color: #4758AB;">margin</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">1</span>, <span class="st" style="color: #20794D;">"cm"</span>))</span>
<span id="cb4-75">plot</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="legend-1-rectangle" class="level2">
<h2 class="anchored" data-anchor-id="legend-1-rectangle">Legend 1: Rectangle</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">side <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">12</span></span>
<span id="cb5-2">padding <span class="ot" style="color: #003B4F;">=</span> <span class="fl" style="color: #AD0000;">0.5</span> </span>
<span id="cb5-3">rect_width <span class="ot" style="color: #003B4F;">=</span>  (side <span class="sc" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">*</span>padding)<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">4</span></span>
<span id="cb5-4">legend_y <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">5</span></span>
<span id="cb5-5">legend_height <span class="ot" style="color: #003B4F;">=</span> <span class="fl" style="color: #AD0000;">3.25</span></span>
<span id="cb5-6">legend_mid <span class="ot" style="color: #003B4F;">=</span> legend_y <span class="sc" style="color: #5E5E5E;">+</span> legend_height<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb5-7"></span>
<span id="cb5-8">dfa <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">tibble</span>(<span class="at" style="color: #657422;">xmin =</span> padding <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">0</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">3</span><span class="sc" style="color: #5E5E5E;">*</span>rect_width,</span>
<span id="cb5-9">             <span class="at" style="color: #657422;">xmax =</span> padding <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">4</span><span class="sc" style="color: #5E5E5E;">*</span>rect_width,</span>
<span id="cb5-10">             <span class="at" style="color: #657422;">ymin =</span> legend_y,</span>
<span id="cb5-11">             <span class="at" style="color: #657422;">ymax =</span> legend_y <span class="sc" style="color: #5E5E5E;">+</span> legend_height,</span>
<span id="cb5-12">             <span class="at" style="color: #657422;">fill =</span> <span class="fu" style="color: #4758AB;">unname</span>(abortion_colors)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">xmid =</span>(xmin <span class="sc" style="color: #5E5E5E;">+</span>xmax)<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb5-14">legend_risk <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">ggplot</span>() <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb5-15">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## Container (10 by 10)</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;">geom_rect</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xmin =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">xmax =</span> <span class="dv" style="color: #AD0000;">10</span>, </span>
<span id="cb5-17">                <span class="at" style="color: #657422;">ymin =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">ymax =</span> <span class="dv" style="color: #AD0000;">10</span>),</span>
<span id="cb5-18">            <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"white"</span>) <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb5-19">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## Legend for rectangles</span></span>
<span id="cb5-20">  <span class="fu" style="color: #4758AB;">geom_rect</span>(dfa, <span class="at" style="color: #657422;">mapping =</span> </span>
<span id="cb5-21">              <span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xmin =</span> xmin, <span class="at" style="color: #657422;">xmax =</span> xmax, </span>
<span id="cb5-22">                  <span class="at" style="color: #657422;">ymin =</span> ymin, <span class="at" style="color: #657422;">ymax =</span> ymax),</span>
<span id="cb5-23">            <span class="at" style="color: #657422;">fill =</span> dfa<span class="sc" style="color: #5E5E5E;">$</span>fill) <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb5-24">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## Left label</span></span>
<span id="cb5-25">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"Accessible</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">(Protected)"</span>, <span class="at" style="color: #657422;">x =</span> xmid),</span>
<span id="cb5-26">            <span class="at" style="color: #657422;">x =</span> dfa[<span class="dv" style="color: #AD0000;">1</span>,]<span class="sc" style="color: #5E5E5E;">$</span>xmid, <span class="at" style="color: #657422;">y =</span> legend_mid,</span>
<span id="cb5-27">            <span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">2.9</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb5-28">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## Center label</span></span>
<span id="cb5-29">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"Accessible</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">(Not protected)"</span>),</span>
<span id="cb5-30">            <span class="at" style="color: #657422;">x =</span> dfa[<span class="dv" style="color: #AD0000;">2</span>,]<span class="sc" style="color: #5E5E5E;">$</span>xmid, <span class="at" style="color: #657422;">y =</span> legend_mid ,</span>
<span id="cb5-31">            <span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">2.9</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb5-32">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## Rigth label</span></span>
<span id="cb5-33">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"Hostile"</span>),</span>
<span id="cb5-34">            <span class="at" style="color: #657422;">x =</span> dfa[<span class="dv" style="color: #AD0000;">3</span>,]<span class="sc" style="color: #5E5E5E;">$</span>xmid, <span class="at" style="color: #657422;">y =</span> legend_mid ,</span>
<span id="cb5-35">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">3</span>,</span>
<span id="cb5-36">            <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">'white'</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb5-37">  <span class="do" style="color: #5E5E5E;
font-style: italic;">## Rigth label</span></span>
<span id="cb5-38">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"Illegal"</span>),</span>
<span id="cb5-39">            <span class="at" style="color: #657422;">x =</span> dfa[<span class="dv" style="color: #AD0000;">4</span>,]<span class="sc" style="color: #5E5E5E;">$</span>xmid, <span class="at" style="color: #657422;">y =</span> legend_mid,</span>
<span id="cb5-40">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">3</span>,</span>
<span id="cb5-41">            <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"white"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb5-42">  <span class="fu" style="color: #4758AB;">theme_void</span>()</span>
<span id="cb5-43"></span>
<span id="cb5-44">title_rect <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ggdraw</span>() <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb5-45">  <span class="fu" style="color: #4758AB;">draw_label</span>(</span>
<span id="cb5-46">    <span class="st" style="color: #20794D;">"Rectangle show state</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">attitude towards abortion"</span>,</span>
<span id="cb5-47">    <span class="at" style="color: #657422;">fontface =</span> <span class="st" style="color: #20794D;">'bold'</span>,</span>
<span id="cb5-48">    <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb5-49">    <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb5-50">    <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">10</span></span>
<span id="cb5-51">  ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb5-52">  <span class="fu" style="color: #4758AB;">theme</span>(</span>
<span id="cb5-53">    <span class="co" style="color: #5E5E5E;"># add margin on the left of the drawing canvas,</span></span>
<span id="cb5-54">    <span class="co" style="color: #5E5E5E;"># so title is aligned with left edge of first plot</span></span>
<span id="cb5-55">    <span class="at" style="color: #657422;">plot.margin =</span> <span class="fu" style="color: #4758AB;">margin</span>(<span class="dv" style="color: #AD0000;">6</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb5-56">  )</span>
<span id="cb5-57">rect_legend <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">plot_grid</span>(</span>
<span id="cb5-58">  title_rect, legend_risk,</span>
<span id="cb5-59">  <span class="at" style="color: #657422;">ncol =</span> <span class="dv" style="color: #AD0000;">1</span>,</span>
<span id="cb5-60">  <span class="at" style="color: #657422;">rel_heights =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">2</span>, <span class="dv" style="color: #AD0000;">8</span>)</span>
<span id="cb5-61">)</span>
<span id="cb5-62"></span>
<span id="cb5-63">rect_legend</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="legend-2-paid-family-leave" class="level2">
<h2 class="anchored" data-anchor-id="legend-2-paid-family-leave">Legend 2: Paid family leave</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Create funciton to layout for legend</span></span>
<span id="cb6-2">geom_hex_legend_for_alina <span class="ot" style="color: #003B4F;">=</span> <span class="cf" style="color: #003B4F;">function</span>(gg){</span>
<span id="cb6-3">  gg <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-4">    <span class="fu" style="color: #4758AB;">geom_rect</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xmin =</span>  <span class="dv" style="color: #AD0000;">0</span> <span class="sc" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">*</span>height<span class="sc" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">1.4</span>, <span class="at" style="color: #657422;">xmax =</span> height <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">*</span>height<span class="sc" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">1.4</span>,   </span>
<span id="cb6-5">                  <span class="at" style="color: #657422;">ymin =</span> <span class="dv" style="color: #AD0000;">0</span> <span class="sc" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">*</span>height, <span class="at" style="color: #657422;">ymax =</span> height <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">*</span>height),</span>
<span id="cb6-6">              <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"white"</span>) </span>
<span id="cb6-7">}</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Legend 2: Blue triangle</span></span>
<span id="cb6-10">title_hex_blue <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ggdraw</span>() <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;">draw_label</span>(</span>
<span id="cb6-12">    <span class="st" style="color: #20794D;">"Blue Triangles show </span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;"> paid family policy"</span>,</span>
<span id="cb6-13">    <span class="at" style="color: #657422;">fontface =</span> <span class="st" style="color: #20794D;">'bold'</span>,</span>
<span id="cb6-14">    <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb6-15">    <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb6-16">    <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">10</span></span>
<span id="cb6-17">  ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;">theme</span>( <span class="at" style="color: #657422;">plot.margin =</span> <span class="fu" style="color: #4758AB;">margin</span>(<span class="dv" style="color: #AD0000;">5</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb6-19">legend_hex_blue <span class="ot" style="color: #003B4F;">=</span> data_processed <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-20">  <span class="fu" style="color: #4758AB;">filter</span>(state <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"WA"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-21">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">state =</span> <span class="st" style="color: #20794D;">""</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-22">  <span class="fu" style="color: #4758AB;">ggplot</span>()  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-23">  <span class="fu" style="color: #4758AB;">geom_hex_legend_for_alina</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;">geom_hex_for_alina</span>()</span>
<span id="cb6-25">hex_legend_blue <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">plot_grid</span>(</span>
<span id="cb6-26">  title_hex_blue, legend_hex_blue,</span>
<span id="cb6-27">  <span class="at" style="color: #657422;">ncol =</span> <span class="dv" style="color: #AD0000;">1</span>,</span>
<span id="cb6-28">  <span class="at" style="color: #657422;">rel_heights =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">2</span>, <span class="dv" style="color: #AD0000;">8</span>)</span>
<span id="cb6-29">)</span>
<span id="cb6-30"></span>
<span id="cb6-31">hex_legend_blue</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="legend-3-preemption" class="level2">
<h2 class="anchored" data-anchor-id="legend-3-preemption">Legend 3: Preemption</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Legend 3: Red triangle </span></span>
<span id="cb7-2">title_hex_red <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ggdraw</span>() <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;">draw_label</span>(</span>
<span id="cb7-4">    <span class="st" style="color: #20794D;">"Red triangles show state</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">preemption of paid</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">family policies"</span>,</span>
<span id="cb7-5">    <span class="at" style="color: #657422;">fontface =</span> <span class="st" style="color: #20794D;">'bold'</span>,</span>
<span id="cb7-6">    <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb7-7">    <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb7-8">    <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">10</span></span>
<span id="cb7-9">  ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;">theme</span>(</span>
<span id="cb7-11">    <span class="at" style="color: #657422;">plot.margin =</span> <span class="fu" style="color: #4758AB;">margin</span>(<span class="dv" style="color: #AD0000;">5</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb7-12">  )</span>
<span id="cb7-13">legend_hex_red <span class="ot" style="color: #003B4F;">=</span> data_processed <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;">filter</span>(state <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"FL"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">state =</span> <span class="st" style="color: #20794D;">""</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;">ggplot</span>()  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-17">  <span class="fu" style="color: #4758AB;">geom_hex_legend_for_alina</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-18">  <span class="fu" style="color: #4758AB;">geom_hex_for_alina</span>()</span>
<span id="cb7-19">hex_legend_red <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">plot_grid</span>(</span>
<span id="cb7-20">  title_hex_red, legend_hex_red,</span>
<span id="cb7-21">  <span class="at" style="color: #657422;">ncol =</span> <span class="dv" style="color: #AD0000;">1</span>,</span>
<span id="cb7-22">  <span class="at" style="color: #657422;">rel_heights =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">3</span>, <span class="dv" style="color: #AD0000;">8</span>)</span>
<span id="cb7-23">)</span>
<span id="cb7-24">hex_legend_red</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="layout-for-deliverable" class="level1">
<h1>Layout for Deliverable</h1>
<p>This is saved in “./output/issue5.jpeg”.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">title <span class="ot" style="color: #003B4F;">=</span>  <span class="fu" style="color: #4758AB;">ggdraw</span>() <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;">draw_label</span>(</span>
<span id="cb8-3">    <span class="st" style="color: #20794D;">"Abortion, Paid Family Leave and Preemption Policy by U.S. State"</span>,</span>
<span id="cb8-4">    <span class="at" style="color: #657422;">fontface =</span> <span class="st" style="color: #20794D;">'bold'</span>,</span>
<span id="cb8-5">    <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb8-6">    <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">0.5</span>,</span>
<span id="cb8-7">    <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">14</span></span>
<span id="cb8-8">  ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb8-9">  <span class="fu" style="color: #4758AB;">theme_void</span>()<span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb8-10">  <span class="fu" style="color: #4758AB;">theme</span>( <span class="at" style="color: #657422;">plot.margin =</span> <span class="fu" style="color: #4758AB;">margin</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">0</span>),</span>
<span id="cb8-11">         <span class="at" style="color: #657422;">plot.background =</span> <span class="fu" style="color: #4758AB;">element_rect</span>(<span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"#f2f2f2"</span>, <span class="at" style="color: #657422;">colour =</span> <span class="st" style="color: #20794D;">'white'</span> ),</span>
<span id="cb8-12">        </span>
<span id="cb8-13">         )</span>
<span id="cb8-14"></span>
<span id="cb8-15">legend <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">plot_grid</span>(rect_legend,hex_legend_blue,hex_legend_red,</span>
<span id="cb8-16">                   <span class="at" style="color: #657422;">ncol =</span> <span class="dv" style="color: #AD0000;">3</span>,</span>
<span id="cb8-17">                   <span class="at" style="color: #657422;">rel_widths =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">7</span>, <span class="dv" style="color: #AD0000;">4</span>, <span class="dv" style="color: #AD0000;">4</span>))</span>
<span id="cb8-18"></span>
<span id="cb8-19"></span>
<span id="cb8-20">figure <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">plot_grid</span>(title,</span>
<span id="cb8-21">                   <span class="cn" style="color: #8f5902;">NULL</span>,</span>
<span id="cb8-22">                   legend,</span>
<span id="cb8-23">                   <span class="cn" style="color: #8f5902;">NULL</span>,</span>
<span id="cb8-24">                   plot,</span>
<span id="cb8-25">                   <span class="at" style="color: #657422;">ncol =</span> <span class="dv" style="color: #AD0000;">1</span>,</span>
<span id="cb8-26">                   <span class="at" style="color: #657422;">rel_heights =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="fl" style="color: #AD0000;">0.5</span>,<span class="fl" style="color: #AD0000;">0.2</span>,<span class="dv" style="color: #AD0000;">2</span>,<span class="fl" style="color: #AD0000;">0.2</span>,<span class="dv" style="color: #AD0000;">7</span>)) </span>
<span id="cb8-27"> </span>
<span id="cb8-28"></span>
<span id="cb8-29"><span class="fu" style="color: #4758AB;">ggsave</span>(<span class="at" style="color: #657422;">filename =</span> <span class="st" style="color: #20794D;">"output/issue5.jpeg"</span>,</span>
<span id="cb8-30">       <span class="at" style="color: #657422;">plot =</span> figure,</span>
<span id="cb8-31">       <span class="at" style="color: #657422;">height =</span> <span class="dv" style="color: #AD0000;">8</span>,</span>
<span id="cb8-32">       <span class="at" style="color: #657422;">width =</span> <span class="dv" style="color: #AD0000;">8</span></span>
<span id="cb8-33">       )</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/output/issue5.jpeg" class="img-fluid figure-img"></p>
</figure>
</div>


<!-- -->

</section>

 ]]></description>
  <category>visualization</category>
  <category>infographic</category>
  <guid>https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/quarto.html</guid>
  <pubDate>Wed, 10 Aug 2022 04:00:00 GMT</pubDate>
  <media:content url="https://Drexel-UHC.github.io/analytics-corner/pages/blog/issues/7 - Abortion and Paid Family Leave figure/images/paste-24B14202.png" medium="image" type="image/png" height="160" width="144"/>
</item>
</channel>
</rss>
