---
title: "#3 - Help with grant informatics infrastructure language"
format: 
  html:
    toc: true
    toc-location: left
    df-print: paged
author: Ran Li
execute: 
  warning: false
  echo: false
editor_options: 
  chunk_output_type: console
---

# Issue

## Description

**URL: https://github.com/Drexel-UHC/analytics-core/issues/7**

> I'm hoping to make a figure that shows different policy statuses of states (abortion ban, proposed abortion ban, no abortion ban; Paid family leave, no paid family leave; paid family leave preemption, no preemption), with the states in the location of the US map...
>
> I think geofacet mightttt get us close to the figure I'm hoping to make, but not quitee there.

## Example

![](images/paste-24B14202.png){width="448"}

## Unpacking

Just a brief breakdown of the plot above from the [original article](https://www.scientificamerican.com/article/graphic-many-states-that-restrict-or-ban-abortion-dont-teach-kids-about-sex-and-pregnancy/). There are two layers: 1) rectangles show abortion policy categories 2) triangles show various degrees of coverage within sexual education by topic (contraception in blue vs abstinence in orange). In other words larger/more-orange triangle at bottom indicates more sexual seduction emphasize abstinence and large/more-blue triangle at top indicates more sexual education emphasis on contraception. In terms of data there each state would have three points: abortion policy categories, coverage of contraception, coverage of abstinence.

Lets take a look at the data sent over along with this request.

```{r}
library(janitor)
library(readxl)
library(tidyverse)
library(geofacet)

## raw data
raw_data = readxl::read_excel(path = "raw-data/family medical leave preemption dataset.xlsx",
                          sheet = 'Sheet2') %>% 
  drop_na() %>% 
  select(name = 1, family_leave = 2, preemption = 3, abortion_ban_risk = 4)  

## clean state codes
xwalk_states = geofacet::state_ranks %>% 
  select(name, state) %>% 
  distinct()
data = raw_data %>% 
  mutate(name = name %>% recode("Washington DC" = "District of Columbia" )) %>% 
  left_join(xwalk_states)
data

```

Adapting this visualization to the table above would give the following features:

1. The rectangle would be similiar with shade mapping to the abortion ban risk
2. The top blue triangle would map to family leave.
3. The bottom orange triangle would map to preemption family leave. I am assuming preemption is bad?







